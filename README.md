## Образ и предпочтения инопланетян


## Внешность инопланетян

Инопланетяне могут иметь разнообразные формы тела, цвета кожи и свечения. Они часто обладают несколькими глазами или антеннами. 

![Типичный инопланетянин](./assets/alien.jpg)

Типичный инопланетянин представлен выше (типичный для Stable Diffusion v1.5)

## Предпочтения при выборе отеля

- **Экзотический ландшафт**: Инопланетяне предпочитают отели, расположенные в экзотических местах, таких как берег кислородного озера или под гигантскими грибами.

- **Уникальная архитектура**: Они ценят отели с уникальной архитектурой, например, с плавающими крышами и витражами.

- **Безопасность и спокойствие**: Для инопланетян важна безопасность и спокойствие, поэтому они выбирают места, где нет земных опасностей.

Теперь мы можно приступить к формированию образов и описаний отелей, соответствующих предпочтениям инопланетян.

## Изучение датасета

**Что такое image captioning?**

Image captioning - это задача генерации текстового описания для изображения. В данной задаче компьютерная модель принимает на вход изображение и генерирует текстовое описание, которое наилучшим образом описывает содержание изображения. Это сочетание компьютерного зрения и естественного языка, что делает задачу сложной и интересной.

**Почему над этим работают?**

Работа над image captioning имеет ряд практических применений. Например, она может использоваться для автоматического добавления описаний к фотографиям в социальных сетях, улучшения доступности для людей с нарушениями зрения, создания систем навигации для роботов и многих других приложений.

**Как формулируется задача?**

Задача image captioning формулируется как генерация текстовой последовательности (описания) на основе входного изображения. Основные шаги задачи:

Модель получает на вход изображение (например, в виде вектора признаков, извлеченных из некоторого image encoder-а).
Модель генерирует текстовую последовательность, начиная с токена начала последовательности (например, "start").
На каждом шаге модель предсказывает следующий токен, исходя из предыдущих токенов и входного изображения.
Процесс генерации продолжается до тех пор, пока модель не сгенерирует токен конца последовательности (например, "end") или достигнет максимальной длины описания.

### Аннотация датасета и ответы на вопросы:
Colab с анализом датасета:
https://colab.research.google.com/drive/1X4axiBLyMqIvkbNMnn9tsRpigY3qet1a?usp=sharing

**Что представлено на изображениях?**

Датасет Hotels-50K на Kaggle представляет собой коллекцию фотографий отелей. Каждая фотография изображает интерьер или экстерьер отеля.

**Сколько объектов в датасете?**

В тренировочной части датасета 1124215 изображений.

**Сколько уникальных классов?**

В датасете Hotels-50K содержится фотографии 50000 отелей.  

**Сбалансирован ли датасет?**

Датасет несбалансирован, что хорошо показано на гистограмме в Colab. Количество изображений варьируется от 0 до 400+.

**Какие параметры у изображений?**

Изображения трехканальныйе и могут быть как вертикальными, так и горизонтальными

**Размер фотографий?**

Размер изображений travel_website порядка 350x235 для вертикальных фотографий и 235x350 для горизонтальных 
При это есть фотографии traffickcam высокого разрешения 2952x5248 и 5334x4008

## Изменение изображения при помощи диффузионной модели
**Выбор фотографий**

Были выбраны следующие фотографии: ![Фото](./assets/rooms.jpg)

## Изменение фотографий
Для изменения фотографий использована [StableDiffusionMagic](https://github.com/rupeshs/diffusionmagic?ysclid=llkknjn6pv895581605)

Попробуем немного изменить подсветку комнаты, чтобы инопланетным гостям привычнее смотрелось.

![Фото](./assets/gen1.jpg)

Также добавим более привычную подсветку и в ванную комнату, а также более привычных обитателей.

![Фото](./assets/gen2.jpg)

Немного изменим вид за окном.
![Фото](./assets/gen3.jpg)


## Улучшения
- Контролировать сохранность контента можно регулирая уровень classifier-free guidance (чем меньше, тем больше оригинального контента сохранится)
- Можно обучить стилевой токен на нескольких изображениях, соответствующих запросу инопланетян, а потом добавлять этот токен в промпт. Этот подход называется Textual Inversion (https://huggingface.co/docs/diffusers/training/text_inversion)
- Применить идею из статьи https://arxiv.org/pdf/2210.09276.pdf. В ней сохранность оригинального контента задается параметром alpha (изменяется от 0 до 1, при alpha близким к 0 изображение похоже на оригинальное, при близким к 1 получается почти новое изображение)